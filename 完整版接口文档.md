# 前言

所有数据都会进行外层封装：

| 字段 | 类型   | 说明                                         |
| ---- | ------ | -------------------------------------------- |
| code | int    | 等于0成功，非0失败                           |
| msg  | string | 调用返回的信息，可能是错误信息或成功展示信息 |
| data | {}     | 数据                                         |

说明：

1. 若在下面接口中无返回值，则其成功与否看code，错误或成功信息看msg。

2. 除get以url参数方式提供请求数据外，其他请求数据请封装成json提交。

3. 需要登录的接口，需要设置键为User-Token的请求header，例如User-Token: 123；其中token登录获取。

4. 所有路径均为相对路径，相对于**域名/api/v1**。

5. 列表形接口返回数据示例：

   ```json
   {
   	"code": 0,
   	"msg": "获取所有板块列表成功",
   	"data": {
   		"count": 2,
   		"list": [{
   				"section_id": 1,
   				"name": "板块1"
   			},
   			{
   				"section_id": 2,
   				"name": "板块2"
   			}
   		]
   	}
   }
   ```

   

# 无需登录接口

## 注册

| 方式 | 路径      |
| ---- | --------- |
| POST | /register |

请求：

| 字段     | 类型   | 说明 |
| -------- | ------ | ---- |
| email    | string | 邮箱 |
| nickname | string | 昵称 |
| password | string | 密码 |



## 登录

| 方式 | 路径   |
| ---- | ------ |
| POST | /login |

请求：

| 字段     | 类型   | 说明 |
| -------- | ------ | ---- |
| email    | string | 邮箱 |
| password | string | 密码 |

返回：

| 字段  | 类型   | 说明         |
| ----- | ------ | ------------ |
| token | string | 用户登录凭证 |



## 所有板块

| 方式 | 路径          |
| ---- | ------------- |
| GET  | /section/list |

返回：

| 字段  | 类型        | 说明     |
| ----- | ----------- | -------- |
| count | int         | 总数     |
| list  | []list_item | 板块列表 |

list_item：

| 字段       | 类型   | 说明   |
| ---------- | ------ | ------ |
| section_id | int    | 板块id |
| name       | string | 板块名 |



## 板块页帖子列表

| 方式 | 路径                             |
| ---- | -------------------------------- |
| GET  | /section/{section_id}/topic/list |

请求：

| 字段  | 类型 | 说明     |
| ----- | ---- | -------- |
| page  | int  | 页数     |
| limit | int  | 每页个数 |

返回：

| 字段  | 类型        | 说明     |
| ----- | ----------- | -------- |
| count | int         | 总数     |
| list  | []list_item | 帖子列表 |

list_item:

| 字段          | 类型   | 说明           |
| ------------- | ------ | -------------- |
| topic_id      | int    | 贴子id         |
| user_nickname | string | 发帖人         |
| title         | string | 帖子标题       |
| introduction  | string | 帖子内容简介   |
| create_time   | int    | 发布时间戳     |
| comment_time  | int    | 最近评论时间戳 |
| view_count    | int    | 浏览量         |



## 搜索

| 方式 | 路径    |
| ---- | ------- |
| GET  | /search |

请求：

| 字段    | 类型   | 说明     |
| ------- | ------ | -------- |
| content | string | 搜索内容 |
| page    | int    | 页数     |
| limit   | int    | 每页个数 |

返回：

| 字段  | 类型        | 说明     |
| ----- | ----------- | -------- |
| count | int         | 总数     |
| list  | []list_item | 帖子列表 |

list_item:

| 字段          | 类型   | 说明           |
| ------------- | ------ | -------------- |
| topic_id      | int    | 贴子id         |
| user_nickname | string | 发帖人         |
| title         | string | 帖子标题       |
| introduction  | string | 帖子内容简介   |
| create_time   | int    | 发布时间戳     |
| comment_time  | int    | 最近评论时间戳 |
| view_count    | int    | 浏览量         |



## 帖子详情

| 方式 | 路径                     |
| ---- | ------------------------ |
| GET  | /topic/{topic_id}/detail |

返回：

| 字段          | 类型   | 说明                             |
| ------------- | ------ | -------------------------------- |
| user_nickname | string | 发帖人                           |
| title         | string | 帖子标题                         |
| content       | string | 帖子内容                         |
| create_time   | int    | 发布时间戳                       |
| comment_time  | int    | 最近评论时间戳                   |
| view_count    | int    | 浏览量                           |
| thumb_count   | int    | 点赞量                           |
| favor_count   | int    | 收藏量                           |
| can_see       | bool   | 帖子是否可看，被ban或删除为false |



## 帖子回帖列表

| 方式 | 路径                           |
| ---- | ------------------------------ |
| GET  | /topic/{topic_id}/comment/list |

请求：

| 字段  | 类型 | 说明     |
| ----- | ---- | -------- |
| page  | int  | 页数     |
| limit | int  | 每页个数 |

返回：

| 字段  | 类型        | 说明     |
| ----- | ----------- | -------- |
| count | int         | 总数     |
| list  | []list_item | 回复列表 |

list_item:

| 字段          | 类型   | 说明      |
| ------------- | ------ | --------- |
| comment_id    | int    | 评论id    |
| user_nickname | string | 发帖人    |
| content       | string | 帖子内容  |
| comment_time  | int    | 评论时间  |
| ban           | bool   | 是否被ban |



# 用户接口

## 用户信息

### 用户详情

| 方式 | 路径         |
| ---- | ------------ |
| GET  | /user/detail |

返回：

| 字段        | 类型   | 说明       |
| ----------- | ------ | ---------- |
| email       | string | 用户邮箱   |
| nickname    | string | 用户昵称   |
| avatar      | string | 头像链接   |
| create_time | int    | 创建时间戳 |



### 改用户昵称

| 方式  | 路径           |
| ----- | -------------- |
| PATCH | /user/nickname |

请求：

| 字段     | 类型   | 说明 |
| -------- | ------ | ---- |
| nickname | string | 昵称 |



### 改用户密码

| 方式  | 路径           |
| ----- | -------------- |
| PATCH | /user/password |

请求：

| 字段 | 类型   | 说明   |
| ---- | ------ | ------ |
| old  | string | 旧密码 |
| new  | string | 新密码 |



## 帖子操作

### 发帖

| 方式 | 路径        |
| ---- | ----------- |
| POST | /user/topic |

请求：

| 字段       | 类型   | 说明            |
| ---------- | ------ | --------------- |
| section_id | int    | 板块id          |
| title      | string | 标题（最长255） |
| content    | string | 正文            |



### 回帖

| 方式 | 路径                           |
| ---- | ------------------------------ |
| POST | /user/topic/{topic_id}/comment |

请求：

| 字段    | 类型   | 说明     |
| ------- | ------ | -------- |
| content | string | 回复内容 |



### 用户某一帖子记录

| 方式 | 路径                          |
| ---- | ----------------------------- |
| GET  | /user/topic/{topic_id}/record |

返回：

| 字段  | 类型 | 说明     |
| ----- | ---- | -------- |
| thumb | bool | 是否点赞 |
| favor | bool | 是否收藏 |



### 点赞贴子

| 方式 | 路径                         |
| ---- | ---------------------------- |
| PUT  | /user/topic/{topic_id}/thumb |



### 取消点赞

| 方式   | 路径                         |
| ------ | ---------------------------- |
| DELETE | /user/topic/{topic_id}/thumb |



### 收藏贴子

| 方式 | 路径                         |
| ---- | ---------------------------- |
| PUT  | /user/topic/{topic_id}/favor |



### 取消收藏

| 方式   | 路径                         |
| ------ | ---------------------------- |
| DELETE | /user/topic/{topic_id}/favor |



### 举报帖子

| 方式 | 路径                          |
| ---- | ----------------------------- |
| POST | /user/topic/{topic_id}/tipoff |

请求：

| 字段    | 类型   | 说明     |
| ------- | ------ | -------- |
| content | string | 举报说明 |



### 举报回帖

| 方式 | 路径                                    |
| ---- | --------------------------------------- |
| POST | /user/topic/comment/{comment_id}/tipoff |

请求：

| 字段    | 类型   | 说明     |
| ------- | ------ | -------- |
| content | string | 举报说明 |



## 用户记录操作

### 用户发布的贴子列表

| 方式 | 路径             |
| ---- | ---------------- |
| GET  | /user/topic/list |

请求：

| 字段  | 类型 | 说明     |
| ----- | ---- | -------- |
| page  | int  | 页数     |
| limit | int  | 每页个数 |

返回：

| 字段  | 类型        | 说明     |
| ----- | ----------- | -------- |
| count | int         | 总数     |
| list  | []list_item | 帖子列表 |

list_item:

| 字段         | 类型   | 说明       |
| ------------ | ------ | ---------- |
| topic_id     | int    | 帖子id     |
| title        | string | 帖子标题   |
| introduction | string | 帖子简介   |
| create_time  | int    | 发布时间戳 |
| view_count   | int    | 浏览量     |
| thumb_count  | int    | 点赞量     |
| favor_count  | int    | 收藏量     |



### 删自己的帖

| 方式   | 路径                   |
| ------ | ---------------------- |
| DELETE | /user/topic/{topic_id} |



### 浏览历史

| 方式 | 路径               |
| ---- | ------------------ |
| GET  | /user/history/list |

请求：

| 字段  | 类型 | 说明     |
| ----- | ---- | -------- |
| page  | int  | 页数     |
| limit | int  | 每页个数 |

返回：

| 字段  | 类型        | 说明     |
| ----- | ----------- | -------- |
| count | int         | 总数     |
| list  | []list_item | 帖子列表 |

list_item:

| 字段         | 类型   | 说明       |
| ------------ | ------ | ---------- |
| topic_id     | int    | 帖子id     |
| title        | string | 帖子标题   |
| introduction | string | 帖子简介   |
| view_time    | int    | 浏览时间戳 |



### 点赞记录

| 方式 | 路径             |
| ---- | ---------------- |
| GET  | /user/thumb/list |

请求：

| 字段  | 类型 | 说明     |
| ----- | ---- | -------- |
| page  | int  | 页数     |
| limit | int  | 每页个数 |

返回：

| 字段  | 类型        | 说明     |
| ----- | ----------- | -------- |
| count | int         | 总数     |
| list  | []list_item | 帖子列表 |

list_item:

| 字段         | 类型   | 说明       |
| ------------ | ------ | ---------- |
| topic_id     | int    | 帖子id     |
| title        | string | 帖子标题   |
| introduction | string | 帖子简介   |
| thumb_time   | int    | 点赞时间戳 |



### 收藏夹

| 方式 | 路径             |
| ---- | ---------------- |
| GET  | /user/favor/list |

请求：

| 字段  | 类型 | 说明     |
| ----- | ---- | -------- |
| page  | int  | 页数     |
| limit | int  | 每页个数 |

返回：

| 字段  | 类型        | 说明     |
| ----- | ----------- | -------- |
| count | int         | 总数     |
| list  | []list_item | 帖子列表 |

list_item:

| 字段         | 类型   | 说明       |
| ------------ | ------ | ---------- |
| topic_id     | int    | 帖子id     |
| title        | string | 帖子标题   |
| introduction | string | 帖子简介   |
| favor_time   | int    | 收藏时间戳 |



## 管理员

### 帖子举报列表

| 方式 | 路径                     |
| ---- | ------------------------ |
| GET  | /admin/tipoff/topic/list |

请求：

| 字段  | 类型 | 说明     |
| ----- | ---- | -------- |
| page  | int  | 页数     |
| limit | int  | 每页个数 |

返回：

| 字段  | 类型        | 说明     |
| ----- | ----------- | -------- |
| count | int         | 总数     |
| list  | []list_item | 帖子列表 |

list_item:

| 字段        | 类型   | 说明         |
| ----------- | ------ | ------------ |
| tip_id      | int    | 举报工单id   |
| topic_id    | int    | 帖子id       |
| user_id     | int    | 举报者用户id |
| content     | string | 举报内容     |
| tipoff_time | int    | 举报时间戳   |



### 回帖举报列表

| 方式 | 路径                       |
| ---- | -------------------------- |
| GET  | /admin/tipoff/comment/list |

请求：

| 字段  | 类型 | 说明     |
| ----- | ---- | -------- |
| page  | int  | 页数     |
| limit | int  | 每页个数 |

返回：

| 字段  | 类型        | 说明     |
| ----- | ----------- | -------- |
| count | int         | 总数     |
| list  | []list_item | 帖子列表 |

list_item:

| 字段        | 类型   | 说明         |
| ----------- | ------ | ------------ |
| tip_id      | int    | 举报工单id   |
| comment_id  | int    | 回帖id       |
| user_id     | int    | 举报者用户id |
| content     | string | 举报内容     |
| tipoff_time | int    | 举报时间戳   |



### 处理举报工单

设置举报工单为已处理状态

| 方式 | 路径                           |
| ---- | ------------------------------ |
| PUT  | /admin/tipoff/process/{tip_id} |



### 封贴

| 方式   | 路径                    |
| ------ | ----------------------- |
| DELETE | /admin/topic/{topic_id} |



### 封回帖

| 方式   | 路径                        |
| ------ | --------------------------- |
| DELETE | /admin/comment/{comment_id} |



